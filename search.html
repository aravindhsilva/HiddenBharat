<script>
const params = new URLSearchParams(window.location.search);
const city = params.get("city");

const API = "https://aitraveldiscovery.aravindhsilva.workers.dev?city=" + encodeURIComponent(city);
// ⬆️ REPLACE travel-api-aravindh with YOUR actual worker name

const list = document.getElementById("list");
list.innerHTML = "Loading places...";

fetch(API)
  .then(response => response.json())
  .then(data => {
    list.innerHTML = "";

    if (data.error) {
      list.innerHTML = "API Error: " + data.error;
      return;
    }

    if (!data.features || data.features.length === 0) {
      list.innerHTML = "No places found.";
      return;
    }

    data.features.forEach(place => {
      list.innerHTML += `
        <div class="card">
          <h3>${place.properties.name || "Unknown Place"}</h3>
          <button onclick="openMap(${place.geometry.coordinates[1]}, ${place.geometry.coordinates[0]})">
            Directions
          </button>
        </div>
      `;
    });
  })
  .catch(err => {
    list.innerHTML = "Failed to load data. Check Worker URL.";
    console.error(err);
  });

function openMap(lat, lon) {
  window.open(
    "https://www.openstreetmap.org/?mlat=" + lat + "&mlon=" + lon,
    "_blank"
  );
}
</script>

